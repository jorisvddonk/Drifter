<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Drifter - a Space Exploration VR experiment</title>
    <!-- Note: following files contain Noctis IV code ported to JavaScript, and are licensed under the WTOF public license: http://anywherebb.com/wpl/wtof_public_license.html -->
    <script src="niv_globals.js"></script>
		<script src="niv_starmap.js"></script>
		<script src="niv_drawingSpace.js"></script>
		<script src="niv_drawingSurface.js"></script>
		<script src="niv_engine.js"></script>
		<script src="niv_space.js"></script>
    <script src="niv_rand.js"></script>
    <script src="niv_textures.js"></script>
    <!-- End of Noctis IV code -->
  </head>
  <body>
    <button style="position: absolute; z-index: 9999; top: 0px; right: 0px; width: 150px; height: 50px;" onclick="switchScene()">Switch between surface and stardrifter</button>
    <a-scene stats id="scene" vr-mode-ui="enabled: true" global-controller-actions>
      <a-assets>
        <script id="planet_surface" type="html">
          <a-entity planet-fog>
            <a-entity id="planet_geometry" planetsurfacegridmaker></a-entity>
            
            <a-entity follow-camera>
              <a-entity id="sky" geometry="primitive: sphere; radius: 1000;" planet-sky material="shader: sky; side: back"></a-entity>
              <a-entity position="0 0 -3" hide ncc-model="filename: assets/noctis/mammal.ncc"></a-entity>
            </a-entity>

            <a-entity>
              <a-entity light="type: ambient; color: #BBB"></a-entity>
              <a-entity light="type: directional; color: #FFF; intensity: 0.6" position="-0.5 1 1"></a-entity>
            </a-entity>
            
            <a-entity movement-controls="speed: 0.2" id="camera-rig">
              <a-camera wasd-controls-enabled="false" collider-check="targetElement: #planet_geometry"></a-camera>
              <a-plane width="0.1" height="0.1" rotation="-90 0 0" position="0 0 0" debug-show-always></a-plane>
              <a-entity hand-controller-actions>
                <a-entity hand-controls="left" remove-hand-controls>
                  <a-sphere hand-tool="hand: left; name: planet" radius="0.1" position="0 0 0" rotation="0 60 80" planet-space-material></a-sphere>
                </a-entity>
                <a-entity hand-controls="right" remove-hand-controls>
                  <a-entity hand-tool="hand: right; name: map" rotation="0 60 80" material="color: cyan; roughness: 1; metalness: 1;" geometry="primitive: planetsurface; xmin: 0; xmax: 199; ymin: 0; ymax: 199" scale="0.0015 0.0015 0.0015"></a-entity>
                  <a-entity hand-tool="hand: right; name: texture_surface" rotation="0 -20 0" geometry="primitive: plane" texture-material="src: txtr" scale="0.4 0.4 0.4"></a-entity>
                  <a-entity hand-tool="hand: right; name: texture_planet" rotation="0 -20 0" geometry="primitive: plane" texture-material="src: p_background; width: 360; height: 160; type: space" scale="0.36 0.16 0.4"></a-entity>
                </a-entity>
              </a-entity>
            </a-entity>
          </a-entity>
        </script>

        <script id="stardrifter" type="html">
          <a-entity no-fog>
            <a-entity follow-camera>
              <a-entity id="sky" geometry="primitive: sphere; radius: 1000;" material="shader: flat; color: black; side: back"></a-entity>
            </a-entity>

            <a-entity>
              <a-light color="#111" position="-1 1 0"></a-light>
              <a-light type="point" color="#ffc" position="-7.5 2.2 -9"></a-light>

              <a-entity position="0 1.3 0" ncc-model="scale:0.04; filename: assets/noctis/VEHICLE.NCC"></a-entity>
              <a-entity position="0 1.3 0" 3d-starmap="filename: assets/starmap2.bin"></a-entity>
            </a-entity>

            
            <a-entity movement-controls="speed: 0.2" id="camera-rig">
              <a-camera wasd-controls-enabled="false"></a-camera>
              <a-plane width="0.1" height="0.1" rotation="-90 0 0" position="0 0 0" debug-show-always></a-plane>
              <a-entity hand-controller-actions>
                <a-entity hand-controls="left" remove-hand-controls>
                    <a-sphere hand-tool="hand: left; name: planet" radius="0.1" position="0 0 0" rotation="0 60 80" planet-space-material></a-sphere>
                </a-entity>
                <a-entity hand-controls="right" remove-hand-controls>
                  <a-sphere hand-tool="hand: left; name: planet" radius="0.1" position="0 0 0" rotation="0 60 80" planet-space-material></a-sphere>
                </a-entity>
              </a-entity>
            </a-entity>
          </a-entity>

        </script>
      </a-assets>

      <a-entity id="selectedScene" template="src: #stardrifter"></a-entity>
    </a-scene>
  </body>
</html>
